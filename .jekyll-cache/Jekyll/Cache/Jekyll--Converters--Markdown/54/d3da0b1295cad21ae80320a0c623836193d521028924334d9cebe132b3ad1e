I"´<p>Magnet Forensics recently announced on their <a href="https://www.magnetforensics.com/blog/magnet-weekly-ctf-challenge/">blog</a> that they are beginning a weekly CTF challenge. The first question for the challenge went live on October 5th. The blog says that the questions revolve around an Android image that can be found <a href="https://drive.google.com/file/d/1tVTppe4-3Hykug7NrOJrBJT4OXuNOiDO/view?usp=sharing">here</a>. A new challenge will be released each Monday morning on the CTF‚Äôs <a href="https://magnetweeklyctf.ctfd.io/">main website</a>. A week after each challenge is released, it will be closed and blog posts can be made. Points will be awarded based on solving the challenge, creating custom Magnet Artifact and posting it on their Artifact Exchange, and posting a link to your blog post with #MagnetWeeklyCTF. The first challenge is titled <em>‚ÄúChallenge 1 (OCT 5-11) - Mapping the Digits‚Äù</em> and is worth 20 points. The question for the challenge reads <em>‚ÄúWhat time was the file that maps names to IP‚Äôs recently accessed? (Please answer in this format in UTC: mm/dd/yyyy HH:MM:SS)‚Äù</em></p>

<p><img src="https://starwarsfan2099.github.io/public/2020-10-13/question.JPG" alt="Challenge question" /></p>

<p>First, we need to figure out what device the Android image was created from and then load it in Cellebrite Physical Imager. The file given to us is a tar file: <code class="language-plaintext highlighter-rouge">MUS_Android.tar</code>. Extracting the file gives a <code class="language-plaintext highlighter-rouge">data</code> directory that contains a lot of Android filesystem data. Before being able to load this properly in Cellebrite, we need to determine what device the image came from. My favorite way to determine this easily is to look at the Bluetooth device name. This can be found at in the <code class="language-plaintext highlighter-rouge">settings_secure</code> XML file found at <code class="language-plaintext highlighter-rouge">/data/system/users/0/settings_secure.xml</code>. Searching for ‚Äúbluetooth_name‚Äù reveals the value assigned to it is ‚ÄúPixel 3‚Äù.</p>

<p><img src="https://starwarsfan2099.github.io/public/2020-10-13/setting_secure.JPG" alt="Setting secure" /></p>

<p>So this Android image was taken from a Google Pixel 3 phone. With this knowledge, we can fully load it in Cellebrite Physical Analyzer. After opening Physical Analyzer, select <code class="language-plaintext highlighter-rouge">Open Case</code>. Select <code class="language-plaintext highlighter-rouge">Add Evidence</code> &gt; <code class="language-plaintext highlighter-rouge">Open (Advanced)</code>. Then we can hit <code class="language-plaintext highlighter-rouge">Select Device</code> and then set the device to the Google Pixel 3.</p>

<p><img src="https://starwarsfan2099.github.io/public/2020-10-13/pick_device.JPG" alt="Device selection" /></p>

<p>After this, select <code class="language-plaintext highlighter-rouge">Filesystem - Android ADB Backup</code>. Then we are prompted to select the folder or zip file containing the data. Select <code class="language-plaintext highlighter-rouge">Zip Archive</code> and add the tar file. Then select save UFD to save our case to a file. Next before finishing I selected <code class="language-plaintext highlighter-rouge">Carve locations</code> and <code class="language-plaintext highlighter-rouge">Recover data from archives</code> in case it‚Äôs needed for other challenges. Then select <code class="language-plaintext highlighter-rouge">Examine</code> to begin the processing.</p>

<p>Now we can focusing on solving the challenge question. The question has to do with <em>the file that maps names to IP‚Äôs</em>. The service that resolves names to IP addresses is the Domain Name System, or DNS. The file that stores resolved names to IPs is typically <code class="language-plaintext highlighter-rouge">/etc/hosts</code> on Linux systems. Searching for <code class="language-plaintext highlighter-rouge">hosts</code> in Cellebrite reveals that a file called <code class="language-plaintext highlighter-rouge">hosts</code> is located in <code class="language-plaintext highlighter-rouge">/data/adb/modules/hosts/system/etc/hosts</code>. The question wants the last time the file was accessed. Cellebrite shows this in the right hand panel.</p>

<p><img src="https://starwarsfan2099.github.io/public/2020-10-13/time.JPG" alt="Time" /></p>

<p>Converting this to the time format required by the question gives us <code class="language-plaintext highlighter-rouge">03/05/2020 05:50:18</code>. Enter this into the solution box, and we see this is correct! First week down!</p>

<p><img src="https://starwarsfan2099.github.io/public/2020-10-13/solved.JPG" alt="Solved" /></p>
:ET